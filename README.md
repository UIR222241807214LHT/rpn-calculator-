# 🔧 一、项目目标总览

## 🧩 基础版本（优先完成）

* 支持四则运算的逆波兰表达式计算（如：`3 4 + 2 *` ➜ 14）
* 基于 **堆栈（stack）** 实现表达式求值

## 📐 中级版本（扩展功能）

* 增加对 `sin`, `cos`, `tan`, `log` 等常见单目运算符的支持
* 增加错误处理（非法字符、栈空、除以0等）
* 支持浮点数（double）

## 🧠 高级版本（自定义运算符 & 网络爬虫）

* 添加自定义运算符 `$()`，用于美元→人民币转换
* 抓取新浪财经的美元对人民币汇率
* 实现自己的 HTTP 客户端：直接使用 socket + HTTP 协议解析响应

---

# 🗺️ 二、任务路线图

## 🔹 第1阶段：基础逆波兰计算器（四则运算）

1. **输入格式**：

   * 支持用户从命令行输入一个逆波兰表达式，例如：

     ```
     输入: 3 4 + 2 *   → 输出: 14
     ```

2. **使用栈实现逆波兰表达式求值**：

   * 遇到数字就压栈
   * 遇到操作符就弹出两个操作数，进行计算后压回栈中

3. **实现代码模块**：

   * `evaluate_rpn(std::vector<std::string>& tokens)`：输入表达式 token 序列，返回结果

---

## 🔹 第2阶段：扩展支持单目运算符

1. 修改栈处理逻辑：支持判断操作符是 **单目（1个操作数）** 还是 **双目（2个操作数）**

2. 添加支持的函数：

   * `sin x` ➜ `x sin` 形式，如 `3.1415926 sin` → 0
   * 使用 `std::sin`、`std::cos`、`std::log` 等 C++ 标准库函数（`<cmath>`）

3. 增加输入验证 & 错误提示

---

## 🔹 第3阶段：自定义运算符 \$（美元转换为人民币）

1. **新增表达式形式**：

   * `100 $` 表示将 100 美元按当前汇率转换成人民币

2. 实现方式：

   * `$` 运算符调用汇率获取模块（初始阶段可用写死的汇率）

---

## 🔹 第4阶段：联网爬取汇率（不使用库，直接实现HTTP客户端）

1. 使用 **Socket + HTTP协议** 实现一个最基本的 HTTP GET 请求

   * 目标汇率网站，如：

     ```
     http://open.er-api.com/v6/latest/USD
     ```

2. 处理步骤：

   * 使用 C++ 的 `socket()` / `connect()` / `send()` / `recv()` API

   * 手动构造 HTTP 请求报文，如：

     ```http
     GET /v6/latest/USD HTTP/1.1
     Host: open.er-api.com
     Connection: close
     ```

   * 解析 HTML 响应提取汇率字段（可以使用正则或简单字符串查找）

---

# 🧱 三、代码结构建议

```
rpn_calculator/
├── main.cpp # 主程序
├── rpn_evaluator.h/.cpp # 表达式解析与执行
├── math_functions.h/.cpp # sin, cos 等函数支持
├── exchange_rate.h/.cpp # 汇率获取模块
├── http_client.h/.cpp # HTTP 客户端 socket 实现
├── utils.h/.cpp # 字符串处理、token 分割等工具函数
```

---

# 📌 四、开发建议

* 使用 VSCode 的 `tasks.json` + `g++` 配置编译多个 `.cpp` 文件
* 使用 `std::stack` 管理操作数
* 使用 `std::map<std::string, std::function<double(std::vector<double>)>>` 来映射操作符到函数
* 写测试用例：输入表达式 + 预期输出，方便逐步验证

---

# ✨ 示例表达式支持（完整版本）

| 表达式输入  | 说明                         | 输出（假设汇率为7.2） |
| ----------- | ---------------------------- | --------------------- |
| `3 4 +`     | 3 + 4                        | 7                     |
| `3 4 + 2 *` | (3 + 4) * 2                  | 14                    |
| `90 sin`    | sin(90°)，需转弯处理（可选） | 1（或近似）           |
| `100 $()`   | 100美元转人民币              | 720                   |

---

# 🔚 总结

这个项目从基本的数据结构和算法训练出发，逐步拓展到函数编程、模块化设计、网络通信、协议解析，非常适合作为一个进阶 C++ 项目：

* **基础打牢**：栈、字符串解析、表达式处理  
* **能力提升**：函数扩展、错误处理、模块分离  
* **技术拓展**：网络协议实现、网页数据提取、动态数据接入





要为你的**逆波兰式计算器程序**加上一个**图形化操作窗口（GUI）**，并实现**用户输入中缀表达式 → 自动转为逆波兰式 → 交给你已有的 RPN 引擎求值**的功能，可以按以下思路逐步完成：

------

# 🧩 一、选择 GUI 框架（适配 C++）

你可以选择下面这些流行框架来构建界面：

| 框架                   | 特点                                                 |
| ---------------------- | ---------------------------------------------------- |
| **Qt**（推荐）         | 跨平台，功能强大，有按钮、文本框、历史记录等控件支持 |
| **wxWidgets**          | 跨平台，轻量级，适合嵌入式界面                       |
| **ImGui**              | 实时渲染，适合开发调试工具                           |
| **Windows API**        | 原生支持，复杂繁琐，但不依赖第三方库                 |
| **DearPyGui (Python)** | 如你想将核心用 C++ 编译为库，通过 Python 包装调用    |

------

# 🧠 二、界面逻辑设计

你可以按照普通计算器的风格设计界面：

### 元素布局建议：

- 一个多行 **文本框**：显示中缀表达式和结果（如 `3 + 4 * 2 / (1 - 5)`）
- 多个 **按钮**（0–9, +, -, *, /, (, ), pi, sin, $, = 等）
- 一个 **清空按钮**（C）
- 一个 **历史记录区域**（可选）

------

# 🔁 三、表达式处理流程（核心逻辑）

1. **用户点击按钮或输入框输入中缀表达式**
2. **将中缀表达式转换为逆波兰式（RPN）**（见下方说明）
3. **调用你已有的 `evaluate_rpn()` 函数计算结果**
4. **显示结果在界面上**

------

# 🔄 四、中缀转后缀（RPN）的实现

你可以在程序中实现一个经典的 **“Shunting Yard Algorithm”（调度场算法）** 来实现中缀转后缀（RPN）：

- 输入：`3 + 4 * 2 / (1 - 5)`
- 输出：`3 4 2 * 1 5 - / +` → 传给你已有的 RPN 引擎

这个转换模块是你图形界面和现有计算模块的桥梁，**只需实现一次即可反复使用**。

------

# 🎨 五、界面交互细节建议

- 按下按钮自动追加字符到文本框
- 支持键盘输入
- 输入完整后点击 `=` 按钮：
  - 中缀转后缀 → evaluate_rpn → 输出结果
- 网络断开时报错（处理 `$` 失败情况）
- 支持复制结果、清空、历史保存

------

# 🧩 六、开发建议

- 可以将原有 `evaluate_rpn()` 封装为一个模块或库，GUI 只负责界面和表达式转化
- 如果是初学者建议优先尝试 Qt（有设计器可拖拉控件），也有 Python 绑定（PyQt）
- GUI 可以慢慢加功能：比如绘图、单位换算、历史记录、主题皮肤等

------

## ✅ 最终目标效果

- 用户像使用普通计算器一样输入中缀表达式
- 背后自动转为 RPN 表达式
- 程序调用已有逻辑进行计算
- 结果清晰显示在窗口中，具备良好的交互性和视觉效果
- ![{F603B993-3C98-4215-A67B-AEAA81E4DB99}](https://github.com/user-attachments/assets/40254a51-33d2-45d0-b3b3-838b498c9844)


------

